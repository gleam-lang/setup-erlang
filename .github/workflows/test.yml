name: Test

on:
  push:
    branches: master
  pull_request:

strategy: 
  matrix:
    os: [ubuntu-latest, macos-latest, windows-latest]
    otp-version: ["21.3", "22.3", "23.0"]

jobs:
  test:
    runs-on: {{ $matrix.os }}
    steps:
      - uses: actions/checkout@v2.0.0
      - name: Install Erlang/OTP
        uses: ./
        with:
          otp-version: {{ $matrix.otp-version }}
      - name: Run erl
        run: |
          which erl
          erl -eval 'erlang:display({otp_release, erlang:system_info(otp_release)}), halt().' -noshell
      - name: Run rebar3
        run: |
          which rebar3
          rebar3 version
